<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>In Loving Memory of Luxmore Mhizha</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <style>body { 
  font-family: 'Lato', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; 
  line-height: 1.7; 
  background-color: #f8f6f3; 
  color: #4a4a4a; 
  margin: 0; 
}
h1, h2, h3 {
  font-family: 'Lora', serif;
  font-weight: 400;
  color: #2c2c2c;
}
.vibe-container { max-width: 800px; margin: 0 auto; padding: 2rem 1rem; }
a { color: #8a6d4c; }
a:hover { text-decoration: none; color: #6b543a; }

.memorial-portrait {
  width: 150px;
  height: 150px;
  border-radius: 50%;
  object-fit: cover;
  border: 4px solid #fff;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}
.content-card {
  background: #fff; 
  padding: 2.5rem; 
  border-radius: 8px; 
  box-shadow: 0 4px 20px rgba(0,0,0,0.06); 
  margin-bottom: 2.5rem;
}
.vibe-field{position:relative;display:block;margin-bottom:1.5rem}.vibe-field input{width:100%;padding:.75rem;border:1px solid #d1d5db;border-radius:8px;transition:border-color .2s ease;background-color:#fff}.vibe-field input:focus{border-color:#8a6d4c;outline:none}.vibe-field-label{position:absolute;left:12px;top:12px;transform-origin:left top;transition:all .2s ease;color:#6B7280;background:#fff;padding:0 .25rem}.vibe-field input:focus + .vibe-field-label,.vibe-field input:not(:placeholder-shown) + .vibe-field-label{transform:translateY(-50%) scale(.85);top:0;}.vibe-textarea{width:100%;padding:.7rem;border:1px solid #d1d5db;border-radius:8px;resize:vertical;min-height:80px;box-sizing: border-box;background-color:#fff}.vibe-textarea:focus{border-color:#8a6d4c;outline:none}.vibe-btn{padding:.6rem 1.25rem;border-radius:8px;border:1px solid transparent;cursor:pointer;font-weight:600;transition:all .2s ease}.vibe-btn-primary{background:#8a6d4c;color:#fff}.vibe-btn-primary:hover{background:#6b543a}.vibe-table{width:100%;border-collapse:collapse;text-align:left; background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); overflow: hidden;}.vibe-table th,.vibe-table td{padding:.75rem 1rem;border-bottom:1px solid #e5e7eb}.vibe-table th{font-weight:600;color:#374151;background-color:#f9fafb;}.vibe-table tbody tr:last-child td{border-bottom:none;}</style>
</head>
<body>
<main data-vibe-node-id="main-page-container" id="main-page-container" class="vibe-container">
</main>
<section data-vibe-node-id="hero-section-memorial" class="vibe-hero" style="text-align: center; padding: 2rem 0; background: none;">
  <img src="https://mhizhaevents.co.uk/Screenshot_20251015-233728_Instagram.jpg" alt="Luxmore Mhizha" class="memorial-portrait">
  <h1 style="font-size: 3rem; margin-top: 1.5rem; margin-bottom: 0.5rem; font-weight: 500;">In Loving Memory of Luxmore Mhizha</h1>
  <p style="font-size: 1.2rem; color: #666; font-style: italic;">A life cherished, a soul to be missed.</p>
</section>
<section data-vibe-node-id="event-details-section" id="event-details" class="content-card">
  <h2 style="text-align: center; border-bottom: 1px solid #eee; padding-bottom: 1rem; margin-bottom: 1.5rem;">Service & Gathering Details</h2>
  <div style="display: flex; flex-wrap: wrap; justify-content: space-around; text-align: center; gap: 1rem;">
    <div>
      <h3>Date</h3>
      <p>Tuesday, 21st of October 2025</p>
    </div>
    <div>
      <h3>Time</h3>
      <p>11:00 AM</p>
    </div>
    <div>
      <h3>Location</h3>
      <p>The Redeemed Worship Centre, The Lighthouse, 45 Upper Tichborne St, Leicester LE2 1GL</p>
    </div>
  </div>
  <hr style="border: 0; border-top: 1px solid #eee; margin: 2rem 0;">
  <div style="text-align: center;">
    <h3 style="margin-bottom: 0.5rem;">Gathering After Burial</h3>
    <p>Following the service and burial, friends and family are invited to gather at:</p>
    <p style="font-weight: bold; font-size: 1.1rem; margin-top: 0.5rem;">Mother of God Church Hall, LE3 6NZ</p>
  </div>
</section>
<section data-vibe-node-id="rsvp-form-section" id="rsvp-form-section" class="content-card">
  <h2 style="text-align: center;">Kindly RSVP</h2>
  <p style="text-align: center; color: #666; margin-bottom: 2rem;">Please let us know if you will be attending.</p>
  <form id="rsvp-form" data-vibe-form="funeral-rsvp">
    <label class="vibe-field">
      <input type="text" name="fullName" required placeholder=" ">
      <span class="vibe-field-label">Full Name</span>
    </label>
    <label class="vibe-field">
      <input type="email" name="email" required placeholder=" ">
      <span class="vibe-field-label">Email Address</span>
    </label>
    <label class="vibe-field">
      <input type="number" name="guestCount" required placeholder=" " min="1" value="1">
      <span class="vibe-field-label">Number of Guests Attending</span>
    </label>
    <textarea class="vibe-textarea" name="message" rows="3" placeholder="Leave a message or condolence (optional)"></textarea>
    <button type="submit" class="vibe-btn vibe-btn-primary" style="width: 100%; margin-top: 1rem; padding: 0.8rem;">Submit RSVP</button>
  </form>
</section>

<div data-vibe-node-id="admin-page-container" id="admin-page-container" class="vibe-container" style="display:none;">
  <h1 style="text-align: center;">Guest List</h1>
  <p style="text-align: center; color: #666;">List of guests who have RSVP'd for the service.</p>
  <a href="#" style="display: block; text-align: center; margin-bottom: 2rem;">‚Üê Back to Memorial Page</a>
  <div id="guest-list-display">
    <p>Loading guest list...</p>
  </div>
</div>
<footer data-vibe-node-id="page-footer" style="text-align: center; padding: 2rem; color: #888; font-size: 0.9rem;">
  
</footer>
    <script>
/* --- Vibe Database Connector ---
This script is automatically injected into live projects to handle database interactions.
It uses the existing project storage system to save and load form data without
requiring any changes to the backend code.

HOW TO USE:
--------------------------------------------------------------------------------
1. To Save Form Data:
   - Add the 'data-vibe-form' attribute to your <form> tag.
   - The value is a unique name for your form, e.g., "contact-form".
   - Example: <form data-vibe-form="contact-form"> ... </form>
   - The script will automatically capture submissions and save them.

2. To Display Saved Data:
   - Create a container in your HTML where you want the data to appear.
     Example: <div id="results"></div>
   - In your project's JavaScript, call window.vibe.loadData('your-form-name').
   - This function returns a Promise that resolves with an array of all submissions.
   - Example JavaScript:
     ------------------
     async function displaySubmissions() {
         try {
             // 'contact-form' must match the data-vibe-form attribute
             const submissions = await window.vibe.loadData('contact-form');
             const container = document.getElementById('results');
             if (!container) return;
             
             if (!submissions || submissions.length === 0) {
                 container.innerHTML = '<p>No submissions yet.</p>';
                 return;
             }

             // Sort by timestamp, newest first
             submissions.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
             
             container.innerHTML = '<ul>' + submissions.map(item => {
                 const name = item.data.name || 'N/A';
                 const email = item.data.email || 'N/A';
                 const date = new Date(item.timestamp).toLocaleString();
                 return `<li><strong>${name}</strong> (${email}) on ${date}</li>`;
             }).join('') + '</ul>';

         } catch(e) {
             console.error("Failed to display submissions:", e);
             const container = document.getElementById('results');
             if(container) container.innerHTML = "<p style='color:red'>Could not load data.</p>";
         }
     }

     // Run the function if the 'results' element exists
     if (document.getElementById('results')) {
        displaySubmissions();
     }
     ------------------

LIMITATIONS:
This method works by reading the entire list of submissions, adding a new one, and
saving the entire list back. For low-traffic sites (e.g., a portfolio contact form),
this is perfectly fine. However, if two users submit a form at the exact same moment,
it is possible for one of the submissions to be lost. This is not recommended for
applications that expect high volumes of concurrent submissions.
--------------------------------------------------------------------------------
*/
(function() {
    const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx5p0NpHuIfVUuziW4VkqwTJERjAMpgIdKz0yCO4vVkFt38FerGObaxQQxqPJ2h8RB1yA/exec';
    const USER_ID = 'user-e4a3399d-d41c-423f-9f0d-05603a1b4e4b';
    const PROJECT_ID = 'luxmorersvp';
    const CHUNK_SIZE = 1500;

    if (!APPS_SCRIPT_URL || APPS_SCRIPT_URL.includes('YOUR_APPS_SCRIPT') || !USER_ID || !PROJECT_ID) {
        console.warn('VibeDB: Configuration is missing. Database features are disabled.');
        window.vibe = { loadData: () => Promise.resolve([]) };
        return;
    }

    const getFormDbId = (formId) => `${PROJECT_ID}__form__${formId}`;

    function jsonpRequest(action, params = {}) {
        return new Promise((resolve, reject) => {
            const callbackName = 'vibe_jsonp_callback_' + Math.round(100000 * Math.random());
            const script = document.createElement('script');
            let url = `${APPS_SCRIPT_URL}?action=${action}&callback=${callbackName}`;
            for (const key in params) {
                url += `&${key}=${encodeURIComponent(params[key])}`;
            }
            script.src = url;
            window[callbackName] = (data) => {
                delete window[callbackName];
                document.body.removeChild(script);
                if (data.status === 'success') resolve(data.data);
                else reject(new Error(data.message || 'API Error'));
            };
            script.onerror = () => {
                delete window[callbackName];
                document.body.removeChild(script);
                reject(new Error('API request failed.'));
            };
            document.body.appendChild(script);
        });
    }
    
    function decompressData(dataString) {
        const binaryString = atob(dataString);
        const uint8Array = new Uint8Array(binaryString.length);
        for (let i = 0; i < binaryString.length; i++) {
            uint8Array[i] = binaryString.charCodeAt(i);
        }
        const jsonString = new TextDecoder().decode(uint8Array);
        return JSON.parse(jsonString);
    }

    async function saveProjectInChunks(projectId, data) {
        const jsonString = JSON.stringify(data);
        const uint8Array = new TextEncoder().encode(jsonString);
        let binaryString = '';
        uint8Array.forEach(byte => { binaryString += String.fromCharCode(byte); });
        const dataString = btoa(binaryString);

        const chunks = [];
        for (let i = 0; i < dataString.length; i += CHUNK_SIZE) {
            chunks.push(dataString.substring(i, i + CHUNK_SIZE));
        }

        for (let i = 0; i < chunks.length; i++) {
            await jsonpRequest('saveProjectChunk', {
                userId: USER_ID,
                projectId: projectId,
                chunkData: chunks[i],
                chunkIndex: i,
                totalChunks: chunks.length,
                compressed: false,
            });
            await new Promise(resolve => setTimeout(resolve, 100));
        }
    }

    async function saveFormData(formId, formData) {
        const formDbId = getFormDbId(formId);
        let submissions = [];
        try {
            const existingData = await window.vibe.loadData(formId);
            if (Array.isArray(existingData)) {
                submissions = existingData;
            }
        } catch (e) {
            // This is expected if it's the first submission, so we can ignore it.
            console.log('No existing data for this form, creating new list.');
        }
        
        submissions.push({
            timestamp: new Date().toISOString(),
            data: formData
        });

        await saveProjectInChunks(formDbId, submissions);
    }

    // --- Public API ---
    window.vibe = {
        loadData: async function(formId) {
            if (!formId) {
                return Promise.reject(new Error('formId is required.'));
            }
            try {
                const formDbId = getFormDbId(formId);
                const compressedData = await jsonpRequest('loadProject', { userId: USER_ID, projectId: formDbId });
                return decompressData(compressedData);
            } catch (e) {
                 // If loading fails, it likely means no data exists yet. Return an empty array.
                return [];
            }
        }
    };

    // --- Form Interceptor ---
    document.addEventListener('submit', async (e) => {
        const form = e.target;
        const formId = form.getAttribute('data-vibe-form');
        if (!formId) return;

        e.preventDefault();
        const formData = new FormData(form);
        const data = Object.fromEntries(formData.entries());
        const submitButton = form.querySelector('button[type="submit"], input[type="submit"]');
        let originalButtonContent = '';
        if (submitButton) {
            originalButtonContent = submitButton.innerHTML || submitButton.value;
            submitButton.disabled = true;
            submitButton.value = 'Submitting...';
            submitButton.innerHTML = 'Submitting...';
        }

        try {
            await saveFormData(formId, data);
            form.innerHTML = '<p style="text-align: center; color: green; padding: 20px;">Thank you for your submission!</p>';
        } catch (error) {
            console.error('Form submission failed:', error);
            const errorEl = document.createElement('p');
            errorEl.style.color = 'red';
            errorEl.textContent = 'Submission failed. Please try again later.';
            form.appendChild(errorEl);
            if (submitButton) {
                submitButton.disabled = false;
                submitButton.value = originalButtonContent;
                submitButton.innerHTML = originalButtonContent;
            }
        }
    }, true);
})();
</script>
    <script>(function() {async function displayGuestList() {
  const container = document.getElementById('guest-list-display');
  if (!container) return;

  container.innerHTML = '<p>Loading guest list...</p>';
  try {
    const submissions = await window.vibe.loadData('funeral-rsvp');
    if (!submissions || submissions.length === 0) {
      container.innerHTML = '<p>No RSVPs have been submitted yet.</p>';
      return;
    }

    submissions.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

    let totalGuests = 0;
    const tableRows = submissions.map(item => {
      const name = item.data.fullName || 'N/A';
      const email = item.data.email || 'N/A';
      const guestCount = parseInt(item.data.guestCount, 10) || 0;
      const message = item.data.message || '-';
      const date = new Date(item.timestamp).toLocaleString();
      totalGuests += guestCount;
      return `<tr>
          <td>${name}</td>
          <td>${email}</td>
          <td>${guestCount}</td>
          <td>${message}</td>
          <td>${date}</td>
        </tr>`;
    }).join('');

    container.innerHTML = `
      <p style="font-weight: bold; margin-bottom: 1rem;">Total Guests Attending: ${totalGuests}</p>
      <table class="vibe-table">
        <thead>
          <tr>
            <th>Full Name</th>
            <th>Email</th>
            <th>Count</th>
            <th>Message</th>
            <th>RSVP Date</th>
          </tr>
        </thead>
        <tbody>
          ${tableRows}
        </tbody>
      </table>`;

  } catch (e) {
    console.error("Failed to display submissions:", e);
    if (container) container.innerHTML = "<p style='color:red'>Could not load guest list data.</p>";
  }
}

function switchView(showAdmin) {
  const mainPage = document.getElementById('main-page-container');
  const adminPage = document.getElementById('admin-page-container');
  if (showAdmin) {
    mainPage.style.display = 'none';
    adminPage.style.display = 'block';
    displayGuestList();
  } else {
    mainPage.style.display = 'block';
    adminPage.style.display = 'none';
  }
}

(function() {
  function handleHashChange() {
    const isAdminView = window.location.hash === '#admin';
    switchView(isAdminView);
  }

  // Listen for hash changes
  window.addEventListener('hashchange', handleHashChange);

  // Initial check when the page loads
  handleHashChange();
})();})();</script>
</body>
</html>